
<!-- Google Maps API V3 Key, Ver.=3.13 (3.14 is experimental) --> 
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>KML Layers</title>
    <link href="https://google-developers.appspot.com/maps/documentation/javascript/examples/default.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>


<div>Endangered Species Mapper</div>
<div id="map"></div>


<script type="text/javascript">
//$(document).ready(function(){

// Enable the visual refresh
google.maps.visualRefresh = true;


function initialize() {

	var mapDiv = document.getElementById('map');
	// // Crating a MapOptions object with properties
	  var chicago = new google.maps.LatLng(41.875696,-87.624207);

	var mapOptions = {
	    zoom: 11,
	    center: chicago,
	    mapTypeId: google.maps.MapTypeId.ROADMAP
	  }

	// //Creating the map
	var map = new google.maps.Map(mapDiv,mapOptions);

	// Creating overlays
	var nsf = $('#nsf').text()+ '.kmz';
	var nsf_link ="https://s3.amazonaws.com/esmapping_kmz/"+nsf

	// KML overlay
	var speciesLayer = new google.maps.KmlLayer(nsf_link)

	speciesLayer.setMap(map);

	// change KML scale based on map scale
	// google.maps.event.addListener(map,'zoom_changed', function(){
	// 	zoomlevel = map.getZoom();
	// 	if (zoomlevel >= minZoomLevel ){
	// 		speciesLayer.setMap(map);
	// 	}
	// 	else {
	// 		speciesLayer.setMap(null);
	// 	}
	//});


};

google.maps.event.addDomListener(window, 'load', initialize);

//})

</script>

<!-- CSS to control the layout of the map -->
<style type="text/css">
	#map {width:700px; height:500px;}
	#map div { font-weight:bold;}
	#map #iwsw p { font-weight:normal !important;}
</style>
<!-- end CSS -->